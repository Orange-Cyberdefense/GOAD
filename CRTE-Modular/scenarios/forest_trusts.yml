# Forest Trust Attack Scenario Configuration
# This scenario focuses on exploiting forest trust relationships

scenario_name: "Forest Trust Attacks"
description: "Exploit forest trust relationships for cross-forest compromise"
estimated_ram: "14GB"

required_vms:
  - name: "techcorp-dc"
    role: "TechCorp Forest Root Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.10"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-dc"
    role: "Child Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.11"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "bastion-dc"
    role: "Bastion Forest Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.20"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "production-dc"
    role: "Production Forest Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.30"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-mgmt"
    role: "Management Server in TechCorp"
    ram: 2048
    cpus: 1
    ip: "{{ip_range}}.26"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "student"
    role: "Attack Machine"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.100"
    os: "linux"
    box: "kalilinux/rolling"
    box_version: "2023.1.0"

attack_path:
  - "Enumerate forest trust relationships"
  - "Identify trust types (external, forest) and directions (one-way, two-way)"
  - "Check for SID filtering and selective authentication"
  - "Exploit forest trust for lateral movement"
  - "Use SID history abuse for privilege escalation across forests"
  - "Extract trust keys for forging inter-forest TGTs"

references:
  - "CRTE Notion - Forest Trust Attacks section"
