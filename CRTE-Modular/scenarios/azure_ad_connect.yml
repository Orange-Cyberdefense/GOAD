# Azure AD Connect Attack Scenario Configuration
# This scenario focuses on exploiting Azure AD Connect for credential extraction

scenario_name: "Azure AD Connect Attacks"
description: "Exploit Azure AD Connect for credential extraction and privilege escalation"
estimated_ram: "10GB"

required_vms:
  - name: "techcorp-dc"
    role: "TechCorp Forest Root Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.10"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-dc"
    role: "Child Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.11"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-adconnect"
    role: "Azure AD Connect Server"
    ram: 3072
    cpus: 2
    ip: "{{ip_range}}.28"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "student"
    role: "Attack Machine"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.100"
    os: "linux"
    box: "kalilinux/rolling"
    box_version: "2023.1.0"

attack_path:
  - "Identify Azure AD Connect servers in the environment"
  - "Gain access to the Azure AD Connect server"
  - "Extract credentials from the Azure AD Connect database"
  - "Extract credentials from the Azure AD Connect sync service"
  - "Use extracted credentials for privilege escalation in the on-premises environment"
  - "Potentially pivot to Azure resources using extracted credentials"

references:
  - "CRTE Notion - Azure AD Connect Attacks section"
