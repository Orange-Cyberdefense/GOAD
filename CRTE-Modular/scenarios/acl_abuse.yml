# ACL Abuse Attack Scenario Configuration
# This scenario focuses on exploiting misconfigured access control lists

scenario_name: "ACL Abuse"
description: "Exploit misconfigured access control lists for privilege escalation"
estimated_ram: "10GB"

required_vms:
  - name: "techcorp-dc"
    role: "Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.10"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-dc"
    role: "Child Domain Controller"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.11"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-mgmt"
    role: "Management Server with ACL Misconfigurations"
    ram: 2048
    cpus: 1
    ip: "{{ip_range}}.26"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "us-helpdesk"
    role: "Helpdesk Server (Target)"
    ram: 2048
    cpus: 1
    ip: "{{ip_range}}.27"
    os: "windows"
    box: "StefanScherer/windows_2019"
    box_version: "2021.05.15"
    
  - name: "student"
    role: "Attack Machine"
    ram: 2048
    cpus: 2
    ip: "{{ip_range}}.100"
    os: "linux"
    box: "kalilinux/rolling"
    box_version: "2023.1.0"

attack_path:
  - "Enumerate ACLs on domain objects using tools like BloodHound"
  - "Identify misconfigured ACLs (GenericAll, WriteDACL, WriteOwner, etc.)"
  - "Exploit ACL misconfigurations to modify security descriptors"
  - "Add rights to sensitive objects or modify group memberships"
  - "Escalate privileges to domain admin or other privileged roles"

references:
  - "CRTE Notion - ACL Abuse section"
